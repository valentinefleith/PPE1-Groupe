<!DOCTYPE html>
<html lang="fr">
<head>
	<!--Métadonnées-->
	<meta charset="UTF-8"/>
	<title>Script - Tableaux</title>
    <meta name = "author" content = "valentinefleith, ashleyratier, lidanzhang"/>
    <meta name = "keywords" content = "Argent"/>
    <meta name = "description" content = "Projet groupe PPE1"/>

	<!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="script_tableau.css">

    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">
</head>

<body>
    <div class="Bigcontainer">
        <!--Navbar-->
        <nav class="navbar navbar-expand-lg bg-body-tertiary" id="navbar">
            <div class="container-fluid">
                <a class="navbar-brand" href="../index.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-piggy-bank" viewBox="0 0 16 16">
                    <path d="M5 6.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.138-1.496A6.613 6.613 0 0 1 7.964 4.5c.666 0 1.303.097 1.893.273a.5.5 0 0 0 .286-.958A7.602 7.602 0 0 0 7.964 3.5c-.734 0-1.441.103-2.102.292a.5.5 0 1 0 .276.962"/>
                    <path fill-rule="evenodd" d="M7.964 1.527c-2.977 0-5.571 1.704-6.32 4.125h-.55A1 1 0 0 0 .11 6.824l.254 1.46a1.5 1.5 0 0 0 1.478 1.243h.263c.3.513.688.978 1.145 1.382l-.729 2.477a.5.5 0 0 0 .48.641h2a.5.5 0 0 0 .471-.332l.482-1.351c.635.173 1.31.267 2.011.267.707 0 1.388-.095 2.028-.272l.543 1.372a.5.5 0 0 0 .465.316h2a.5.5 0 0 0 .478-.645l-.761-2.506C13.81 9.895 14.5 8.559 14.5 7.069c0-.145-.007-.29-.02-.431.261-.11.508-.266.705-.444.315.306.815.306.815-.417 0 .223-.5.223-.461-.026a.95.95 0 0 0 .09-.255.7.7 0 0 0-.202-.645.58.58 0 0 0-.707-.098.735.735 0 0 0-.375.562c-.024.243.082.48.32.654a2.112 2.112 0 0 1-.259.153c-.534-2.664-3.284-4.595-6.442-4.595zM2.516 6.26c.455-2.066 2.667-3.733 5.448-3.733 3.146 0 5.536 2.114 5.536 4.542 0 1.254-.624 2.41-1.67 3.248a.5.5 0 0 0-.165.535l.66 2.175h-.985l-.59-1.487a.5.5 0 0 0-.629-.288c-.661.23-1.39.359-2.157.359a6.558 6.558 0 0 1-2.157-.359.5.5 0 0 0-.635.304l-.525 1.471h-.979l.633-2.15a.5.5 0 0 0-.17-.534 4.649 4.649 0 0 1-1.284-1.541.5.5 0 0 0-.446-.275h-.56a.5.5 0 0 1-.492-.414l-.254-1.46h.933a.5.5 0 0 0 .488-.393zm12.621-.857a.565.565 0 0 1-.098.21.704.704 0 0 1-.044-.025c-.146-.09-.157-.175-.152-.223a.236.236 0 0 1 .117-.173c.049-.027.08-.021.113.012a.202.202 0 0 1 .064.199z"/>
                    </svg>
                      Projet PPE1</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                  <li class="nav-item">
                    <a class="nav-link" aria-current="page" href="../index.html">Accueil</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" aria-current="page" href="methode.html">Présentation du projet</a>
                  </li>
                  <li class="nav-item dropdown">
                    <a class="nav-link active dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Scripts
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="script_tableau.html">Tableaux</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="script_concordancier.html">Concordanciers</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="script_itrameur.html">iTrameur</a></li>
                    </ul>
                  </li>
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Tableaux
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="../tableaux/tableau_fr.html">Français</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="../tableaux/tableau_en.html">Anglais</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="../tableaux/tableau_zh.html">Chinois</a></li>
                    </ul>
                  </li>
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Analyse
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="analyse_fr.html">Français</a></li>
                      <li><a class="dropdown-item" href="analyse_en.html">Anglais</a></li>
                      <li><a class="dropdown-item" href="analyse_zh.html">Chinois</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="conclusion.html">Conclusion</a></li>
                    </ul>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="nuage.html">Nuages des mots</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>    
<div class="myContainer">
    <!--Choix du mot-->
    <div class="scriptContainer">
        <p class="scriptTitleText">Script de creation des tableaux</p>
            <p class="script">
					<pre>
	<code>
#!/usr/bin/env bash

<span style="color: #5470A4;">if</span> [[ <span style="color: #BF792A;">$#</span> -ne <span style="color: #B35050;">1</span> ]]; <span style="color: #5470A4;">then</span>
    <span style="color: #5470A4;">echo</span> <span style="color: #808080;">"Usage : ./creation_tableaux.sh /chemin/vers/urls.txt"</span>
    <span style="color: #5470A4;">exit</span>
<span style="color: fi"></span>

<span style="color: #BF792A;">URLS=$1</span>

<span style="color: #5470A4;">if</span> [ ! -f "<span style="color: #BF792A;">$URLS</span>" ]; <span style="color: #5470A4;">then</span>
    <span style="color: #5470A4;">echo</span> <span style="color: #808080;">"On attend un fichier, pas un dossier."</span>
    <span style="color: #5470A4;">exit</span>
<span style="color: fi"></span>

<span style="color: #BF792A;">LANGUE=$(basename -s .txt <span style="color: #BF792A;">$URLS</span>)</span>

<span style="color: #5470A4;">if</span> [ <span style="color: #BF792A;">$LANGUE</span> = <span style="color: #808080;">"fr"</span> ]; <span style="color: #5470A4;">then</span>
    <span style="color: #B35050;">MOT="argent"</span>
<span style="color: fi"></span>

<span style="color: #5470A4;">if</span> [ <span style="color: #BF792A;">$LANGUE</span> = <span style="color: #808080;">"en"</span> ]; <span style="color: #5470A4;">then</span>
    <span style="color: #B35050;">MOT="money"</span>
<span style="color: fi"></span>

<span style="color: #5470A4;">if</span> [ <span style="color: #BF792A;">$LANGUE</span> = <span style="color: #808080;">"zh"</span> ]; <span style="color: #5470A4;">then</span>
    <span style="color: #B35050;">MOT="钱"</span>
<span style="color: fi"></span>

<span style="color: #BF792A;">OUTPUT_FILE="</span>../tableaux/tableau_<span style="color: #BF792A;">$LANGUE</span>.html<span style="color: #BF792A;">"</span>

<span style="color: #5470A4;">echo</span> "<!DOCTYPE html>
<html lang=<span style="color: #808080;">\"fr\"</span>>
<head>
    <!--Métadonnées-->
    <meta charset=<span style="color: #808080;">\"UTF-8\"</span>>
    <title>Tableaux- PPE1 Projet Groupe</title>
    <!-- ... (autres métadonnées) ... -->
    <link href=<span style="color: #808080;">\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\"</span> rel=<span style="color: #808080;">\"stylesheet\"</span> integrity=<span style="color: #808080;">\"sha384-...\"</span>>
    <script src=<span style="color: #808080;">\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"</span> integrity=<span style="color: #808080;">\"sha384-...\"</span>></script>
    <link rel=<span style="color: #808080;">\"stylesheet\"</span> type=<span style="color: #808080;">\"text/css\"</span> href=<span style="color: #808080;">\"methode.css\"</span>>
</head>
<body>
    <table class=<span style="color: #808080;">\"table table-striped-columns\"</span>>
        <thead>
            <tr>
                <!-- ... (autres en-têtes de colonnes) ... -->
            </tr>
        </thead>" > <span style="color: #BF792A;">$OUTPUT_FILE</span>

<span style="color: #BF792A;">lineno=1</span>
<span style="color: #5470A4;">while</span> read -r <span style="color: #BF792A;">URL</span>; <span style="color: #5470A4;">do</span>
    <span style="color: #BF792A;">FICHIER_ASPIRATION="</span>../aspirations/<span style="color: #BF792A;">$LANGUE</span>-<span style="color: #BF792A;">$lineno</span>.html<span style="color: #BF792A;">"</span>

    response=$(curl -s -L -w="<span style="color: #BF792A;">%{http_code}</span>" -o="<span style="color: #BF792A;">$FICHIER_ASPIRATION</span>" "<span style="color: #BF792A;">$URL</span>")
    encoding=$(curl -s -I -L -w="<span style="color: #BF792A;">%{content_type}</span>" -o /dev/null "<span style="color: #BF792A;">$URL</span>" | egrep -o="<span style="color: #808080;">charset=\S+</span>" | cut -d\" -f2 | tail -n 1 | tr '<span style="color: #808080;">[:lower:]</span>' '<span style="color: #808080;">[:upper:]</span>')
    COMPTE=<span style="color: #BF792A;">0</span>
    FICHIER_DUMP="<span style="color: #BF792A;">NA</span>"
    FICHIER_CONTEXTE="<span style="color: #BF792A;">NA</span>"
    CONCORDANCIER="<span style="color: #BF792A;">NA</span>"
    <span style="color: #5470A4;">if</span> [ <span style="color: #BF792A;">$response</span> -eq <span style="color: #BF792A;">200</span> ];<span style="color: #5470A4;">then</span>
        <span style="color: #5470A4;">if</span> [[ ! <span style="color: #BF792A;">$encoding</span> == <span style="color: #808080;">"UTF-8"</span> ]]<span style="color: #5470A4;">then</span>
            iconv -f "<span style="color: #BF792A;">$encoding</span>" -t "<span style="color: #808080;">UTF-8</span>" "<span style="color: #BF792A;">$FICHIER_ASPIRATION</span>" > "<span style="color: #BF792A;">temp.html</span>"
            mv "<span style="color: #BF792A;">temp.html</span>" "<span style="color: #BF792A;">$FICHIER_ASPIRATION</span>"
        <span style="color: fi"></span>
        FICHIER_DUMP="../dump-texts/${LANGUE}-${lineno}.txt"
        lynx -assume_charset="UTF-8" -dump -nolist "<span style="color: #BF792A;">$FICHIER_ASPIRATION</span>" > "<span style="color: #BF792A;">$FICHIER_DUMP</span>"

        COMPTE=$(egrep -i -o "<span style="color: #B35050;">$MOT</span>" "<span style="color: #BF792A;">$FICHIER_DUMP</span>" | wc -l)

        FICHIER_CONTEXTE="../contextes/${LANGUE}-${lineno}.txt"
        egrep -i -C 3 "<span style="color: #B35050;">$MOT</span>" "<span style="color: #BF792A;">$FICHIER_DUMP</span>" > <span style="color: #BF792A;">$FICHIER_CONTEXTE</span>

        ./concordancier.sh "<span style="color: #B35050;">$MOT</span>" <span style="color: #BF792A;">$lineno</span> "<span style="color: #BF792A;">$FICHIER_CONTEXTE</span>" "<span style="color: #BF792A;">$LANGUE</span>"
        CONCORDANCIER="../concordances/${LANGUE}-${lineno}.html"
        <span style="color: #5470A4;">echo</span> "<tbody>
            <tr>
                <th><span style="color: #BF792A;">$lineno</span></th><td><span style="color: #BF792A;">$URL</span></td><td><a href='<span style="color: #BF792A;">$FICHIER_ASPIRATION</span>'>Aspiration</a></td><td><a href='<span style="color: #BF792A;">$FICHIER_DUMP</span>'>Dump</a></td><td><a href='<span style="color: #BF792A;">$FICHIER_CONTEXTE</span>'>Contexte</a></td><td><a href='<span style="color: #BF792A;">$CONCORDANCIER</span>'>Concordancier</a></td><td><span style="color: #BF792A;">$response</span></td><td><span style="color: #BF792A;">$encoding</span></td><td><span style="color: #BF792A;">$COMPTE</span></td>
            </tr>
        </tbody>" >> "<span style="color: #BF792A;">$OUTPUT_FILE</span>"
    <span style="color: else"></span>
        FICHIER_ASPIRATION="<span style="color: #808080;">NA</span>"
<span style="color: #5470A4;">echo</span> "<xmp><tbody>
            <tr>
<th>$lineno</th><td>$URL</td><td>$FICHIER_ASPIRATION</td><td>$FICHIER_DUMP</td><td>$FICHIER_CONTEXTE</td><td>$CONCORDANCIER</td><td>$response</td><td>$encoding</td><td>$COMPTE</td>
            </tr>
</tbody></xmp>" >> "<span style="color: #BF792A;">$OUTPUT_FILE</span>"
<span style="color: fi"></span>
    lineno=$(expr <span style="color: #BF792A;">$lineno</span> + <span style="color: #B35050;">1</span>)
    <span style="color: #5470A4;">echo</span> "<span style="color: #808080;">OK</span>"
<span style="color: done"></span>
<span style="color: #5470A4;">echo</span> "<span style="color: #808

</code>
					</pre>
            </div>
        </div>
    </div>

</div>  
</body>
